name: Smart Welcome Bot

on:
  issues:
    types: [opened]

jobs:
  greet-and-label:
    runs-on: ubuntu-latest
    permissions:
      issues: write
    
    steps:
      - name: Smart response based on issue content
        uses: actions/github-script@v7
        with:
          script: |
            const title = context.payload.issue.title.toLowerCase();
            const body = context.payload.issue.body?.toLowerCase() || '';
            let message = 'ğŸ‘‹ Hey @' + context.payload.issue.user.login + '! Thanks for opening this issue.';
            let labels = ['needs-triage'];
            
            // Detect issue type and customize response
            if (title.includes('bug') || body.includes('bug')) {
              message = 'ğŸ› Bug report received, @' + context.payload.issue.user.login + '! Our team will investigate this issue. Thanks for helping us improve!';
              labels = ['bug', 'needs-triage'];
            } else if (title.includes('feature') || body.includes('feature request')) {
              message = 'ğŸ’¡ Feature request noted, @' + context.payload.issue.user.login + '! We love new ideas. Our team will review and discuss this.';
              labels = ['enhancement', 'needs-triage'];
            } else if (title.includes('question') || title.includes('help')) {
              message = 'â“ Question received, @' + context.payload.issue.user.login + '! We\'ll help you out as soon as possible.';
              labels = ['question'];
            } else if (title.includes('documentation') || title.includes('docs')) {
              message = 'ğŸ“š Documentation issue noted, @' + context.payload.issue.user.login + '! Clear docs are important to us.';
              labels = ['documentation'];
            }
            
            // Post the customized comment
            await github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: message + '\n\nHave a great day! ğŸš€'
            });
            
            // Add appropriate labels
            await github.rest.issues.addLabels({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              labels: labels
            });
